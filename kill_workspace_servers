#!/bin/bash

# Script to kill vite/node servers running on workspace ports

echo "==================================="
echo "Stopping Workspace Servers"
echo "==================================="

# Define ports used by workspaces
PORTS=(8081 8082 8083)

for port in "${PORTS[@]}"; do
    echo "Checking port $port..."
    
    # Find process using the port
    PID=$(lsof -ti :$port)
    
    if [ ! -z "$PID" ]; then
        # Get process info
        PROCESS_INFO=$(ps -p $PID -o comm= 2>/dev/null)
        echo "  Found process on port $port: $PROCESS_INFO (PID: $PID)"
        
        # Kill the process
        kill -9 $PID 2>/dev/null
        
        if [ $? -eq 0 ]; then
            echo "  ✓ Killed process on port $port"
        else
            echo "  ✗ Failed to kill process on port $port"
        fi
    else
        echo "  - No process found on port $port"
    fi
done

echo ""
echo "==================================="
echo "Server cleanup complete"
echo "==================================="