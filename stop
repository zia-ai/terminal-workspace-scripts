#!/bin/bash

# Quick stop script - cleanup everything

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

clear

echo -e "${RED}"
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘         Stopping Workspaces          â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo -e "${NC}"
echo ""

# Kill servers
echo "ðŸ›‘ Stopping servers..."
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
for port in 8081 8082 8083; do
    PID=$(lsof -ti :$port 2>/dev/null)
    if [ ! -z "$PID" ]; then
        kill -9 $PID 2>/dev/null
        echo "  âœ“ Stopped server on port $port"
    else
        echo "  - No server on port $port"
    fi
done

echo ""

# Close windows
echo "ðŸªŸ Closing Terminal windows..."
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
RESULT=$(/Users/gregorywhiteside/Projects/.scripts/close_workspaces 2>/dev/null)
if [[ $RESULT == *"Closed"* ]]; then
    echo "  âœ“ Closed all workspace windows"
else
    echo "  - No workspace windows to close"
fi

echo ""
echo -e "${GREEN}âœ¨ All workspaces stopped${NC}"
echo ""